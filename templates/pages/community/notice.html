{% extends "base.html" %}
{% block title %}{{ SITE_NAME }} | ê³µì§€ì‚¬í•­{% endblock %}

{% block content %}
<section class="sec consult-board-wrap community-board">
    <div class="container">
        <div class="board-inner">

            <div class="board-topbar">
                <div class="board-left">
                    <div class="board-title">{{ page_title }}</div>
                </div>

                <div class="board-mid">
                    <form class="board-search" method="get" action="/pages/community/notice">
                        <select name="sort" class="board-select" aria-label="ì •ë ¬">
                            <option value="latest" {% if sort=='latest' %}selected{% endif %}>ìµœì‹ ìˆœ</option>
                            <option value="oldest" {% if sort=='oldest' %}selected{% endif %}>ì˜¤ë˜ëœìˆœ</option>
                        </select>

                        <input name="q" value="{{ q or '' }}" class="board-input" placeholder="ì œëª©/ë‚´ìš© ê²€ìƒ‰" />
                        <button class="board-search-btn" type="submit" aria-label="ê²€ìƒ‰">ğŸ”</button>
                    </form>
                </div>

                <div class="board-right">
                    {% if IS_ADMIN %}
                    <a class="btn btn-dark" href="/pages/community/notice/write" role="button">
                        <span aria-hidden="true">ğŸ“</span> ê¸€ì“°ê¸°
                    </a>
                    {% endif %}
                </div>
            </div>

            <div class="board-table-wrap">
                <table class="board-table">
                    <thead>
                        <tr>
                            <th class="col-no">No</th>
                            <th class="col-title">ì œëª©</th>
                            <th class="col-date">ë“±ë¡ì¼</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% if not posts or posts|length == 0 %}
                        <tr>
                            <td colspan="3" class="board-empty">ë“±ë¡ëœ ê³µì§€ì‚¬í•­ì´ ì—†ìŠµë‹ˆë‹¤.</td>
                        </tr>
                        {% endif %}

                        {% for p in posts %}
                        <tr>
                            <td class="col-no">{{ p["id"] }}</td>
                            <td class="col-title">
                                <a class="board-link" href="/pages/community/notice/{{ p['id'] }}">{{ p["title"] }}</a>
                            </td>
                            <td class="col-date">{{ (p["created_at"] or "")[:10] }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>

            <div class="board-pagination">
                {% if pagination and pagination["pages"] > 1 %}
                {% if pagination["has_prev"] %}
                <a class="pg"
                    href="/pages/community/notice?page={{ pagination['prev_num'] }}&q={{ q or '' }}&sort={{ sort or 'latest' }}">ì´ì „</a>
                {% else %}
                <span class="pg is-disabled">ì´ì „</span>
                {% endif %}

                {% for pno in range(1, pagination["pages"] + 1) %}
                {% if pno == pagination["page"] %}
                <span class="pg is-active">{{ pno }}</span>
                {% else %}
                <a class="pg"
                    href="/pages/community/notice?page={{ pno }}&q={{ q or '' }}&sort={{ sort or 'latest' }}">{{ pno
                    }}</a>
                {% endif %}
                {% endfor %}

                {% if pagination["has_next"] %}
                <a class="pg"
                    href="/pages/community/notice?page={{ pagination['next_num'] }}&q={{ q or '' }}&sort={{ sort or 'latest' }}">ë‹¤ìŒ</a>
                {% else %}
                <span class="pg is-disabled">ë‹¤ìŒ</span>
                {% endif %}
                {% endif %}
            </div>

        </div>
    </div>
</section>
{% endblock %}