{% extends "base.html" %}
{% block title %}{{ SITE_NAME }} | ì˜¨ë¼ì¸ìƒë‹´{% endblock %}

{% block content %}

<section class="sec consult-board-wrap">
    <div class="container">

        <div class="board-inner">

            <!-- ìƒë‹¨ ë°” -->
            <div class="board-topbar">

                <div class="board-left">
                    <a class="board-rss" href="#" aria-label="RSS">RSS</a>
                </div>

                <div class="board-mid">
                    <form class="board-search" method="get" action="/pages/reserve/consult">
                        <select name="sort" class="board-select" aria-label="ì •ë ¬">
                            <option value="latest" {% if sort=='latest' %}selected{% endif %}>ìµœì‹ ìˆœ</option>
                            <option value="oldest" {% if sort=='oldest' %}selected{% endif %}>ì˜¤ë˜ëœìˆœ</option>
                        </select>

                        <input name="q" value="{{ q or '' }}" class="board-input" placeholder="ì œëª©/ë‚´ìš©/ì‘ì„±ì ê²€ìƒ‰" />
                        <button class="board-search-btn" type="submit" aria-label="ê²€ìƒ‰">ğŸ”</button>
                    </form>
                </div>

                <div class="board-right">
                    <!-- âœ… ì˜ˆì•½í™•ì¸ ë²„íŠ¼ ìŠ¤íƒ€ì¼ê³¼ í†µì¼: ì›ë˜ ë²„ì „ ìœ ì§€ -->
                    <a class="btn btn-dark" href="/pages/reserve/consult/write" role="button">
                        <span aria-hidden="true">ğŸ“</span> ìƒë‹´ì‹ ì²­
                    </a>
                </div>

            </div>


            <!-- í…Œì´ë¸” -->
            <div class="board-table-wrap">
                <table class="board-table">
                    <thead>
                        <tr>
                            <th class="col-no">No</th>
                            <th class="col-title">ì œëª©</th>
                            <th class="col-writer">ì‘ì„±ì</th>
                            <th class="col-date">ë“±ë¡ì¼</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% if not posts or posts|length == 0 %}
                        <tr>
                            <td colspan="4" class="board-empty">ë“±ë¡ëœ ìƒë‹´ì´ ì—†ìŠµë‹ˆë‹¤.</td>
                        </tr>
                        {% endif %}

                        {% for p in posts %}
                        <tr>
                            <td class="col-no">{{ p["id"] }}</td>

                            <td class="col-title">
                                {% if p["is_private"] %}
                                <span class="lock">ğŸ”’</span>
                                {% endif %}

                                <a class="board-link" href="/pages/reserve/consult/{{ p['id'] }}">
                                    {{ p["title"] }}
                                </a>

                                {% if p["status"] %}
                                <span class="badge">{{ p["status"] }}</span>
                                {% endif %}
                            </td>

                            <td class="col-writer">{{ (p["name"] or "")|mask_name }}</td>
                            <td class="col-date">{{ (p["created_at"] or "")[:10] }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>

            <!-- í˜ì´ì§€ë„¤ì´ì…˜ -->
            <div class="board-pagination">
                {% if pagination and pagination["pages"] > 1 %}

                {% if pagination["has_prev"] %}
                <a class="pg"
                    href="/pages/reserve/consult?page={{ pagination['prev_num'] }}&q={{ q or '' }}&sort={{ sort or 'latest' }}">ì´ì „</a>
                {% else %}
                <span class="pg is-disabled">ì´ì „</span>
                {% endif %}

                {% for pno in range(1, pagination["pages"] + 1) %}
                {% if pno == pagination["page"] %}
                <span class="pg is-active">{{ pno }}</span>
                {% else %}
                <a class="pg"
                    href="/pages/reserve/consult?page={{ pno }}&q={{ q or '' }}&sort={{ sort or 'latest' }}">{{ pno
                    }}</a>
                {% endif %}
                {% endfor %}

                {% if pagination["has_next"] %}
                <a class="pg"
                    href="/pages/reserve/consult?page={{ pagination['next_num'] }}&q={{ q or '' }}&sort={{ sort or 'latest' }}">ë‹¤ìŒ</a>
                {% else %}
                <span class="pg is-disabled">ë‹¤ìŒ</span>
                {% endif %}

                {% endif %}
            </div>

        </div>
    </div>
</section>

{% endblock %}